<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blicket Trade System</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }

        #tradeWindow {
            display: none;
            margin-top: 20px;
            padding: 10px;
            border: 1px solid #ccc;
            width: 60%;
        }

        #chatBox {
            border: 1px solid #ccc;
            padding: 10px;
            max-height: 150px;
            overflow-y: auto;
            margin-bottom: 20px;
        }

        #yourLocker, #theirLocker {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }

        .lockerItem {
            padding: 10px;
            background-color: #f1f1f1;
            border-radius: 5px;
            cursor: pointer;
        }

        button {
            padding: 10px;
            margin-top: 10px;
            background-color: #28a745;
            color: white;
            border: none;
            cursor: pointer;
        }

        button:disabled {
            background-color: #ccc;
        }
    </style>
</head>
<body>

    <h2>Blicket Trade System</h2>

    <!-- Trade Button -->
    <div>
        <button onclick="startTrade()">Start Trade</button>
    </div>

    <!-- Trade Window -->
    <div id="tradeWindow">
        <h3>Trade with <span id="tradePlayer"></span></h3>

        <!-- Chatbox -->
        <div id="chatBox"></div>

        <!-- Chat Input -->
        <textarea id="chatInput" placeholder="Talk about the trade..." rows="3" style="width: 100%;"></textarea><br>
        <button onclick="sendMessage()">Send</button>

        <h4>Your Locker:</h4>
        <div id="yourLocker"></div>

        <h4>Trade Offer:</h4>
        <div id="theirLocker"></div>

        <!-- Offer and Deal Buttons -->
        <button id="offerButton" onclick="offerBlook()">Offer Blook</button>
        <button id="dealButton" style="display: none;" onclick="confirmDeal()">Confirm Deal</button>
    </div>

    <script>
        // Simulated online players and lockers
        const onlinePlayers = ['jack', 'sara', 'john']; // Example online players
        const playerLocker = ['ðŸŒ‹', 'ðŸ¥‡', 'âš½', 'ðŸŽ¾']; // Example player locker (this should be stored in localStorage)
        localStorage.setItem('locker', JSON.stringify(playerLocker));

        function startTrade() {
            const playerName = prompt("Enter the username of the player you want to trade with:");

            // Check if player is online
            if (!onlinePlayers.includes(playerName)) {
                alert(`${playerName} is not online.`);
                return;
            }

            // Set up the trade window
            document.getElementById('tradeWindow').style.display = 'block';
            document.getElementById('tradePlayer').textContent = playerName;

            // Load player's locker and other playerâ€™s locker
            loadYourLocker();
            loadTheirLocker(playerName);

            // Show offer button
            document.getElementById('offerButton').style.display = 'block';
        }

        function loadYourLocker() {
            const locker = JSON.parse(localStorage.getItem('locker'));
            const lockerDiv = document.getElementById('yourLocker');
            lockerDiv.innerHTML = '';

            locker.forEach(blook => {
                const blookDiv = document.createElement('div');
                blookDiv.className = 'lockerItem';
                blookDiv.textContent = blook;
                blookDiv.onclick = () => selectBlook(blook);
                lockerDiv.appendChild(blookDiv);
            });
        }

        function loadTheirLocker(playerName) {
            // Simulate the other player's locker
            const locker = ['ðŸŒ‹', 'ðŸ¥‡', 'âš¾']; // Example of the other playerâ€™s locker
            const lockerDiv = document.getElementById('theirLocker');
            lockerDiv.innerHTML = '';

            locker.forEach(blook => {
                const blookDiv = document.createElement('div');
                blookDiv.className = 'lockerItem';
                blookDiv.textContent = blook;
                lockerDiv.appendChild(blookDiv);
            });
        }

        let selectedBlook = null;

        function selectBlook(blook) {
            selectedBlook = blook;
            alert(`You selected ${blook} to offer.`);
        }

        function offerBlook() {
            if (!selectedBlook) {
                alert('Please select a blook to offer first.');
                return;
            }

            // Add your offer to chat
            const chatBox = document.getElementById('chatBox');
            const message = document.createElement('div');
            message.textContent = `You offered: ${selectedBlook}`;
            chatBox.appendChild(message);

            // Simulate the other player offering something
            setTimeout(() => {
                const otherMessage = document.createElement('div');
                otherMessage.textContent = `The other player offered: ðŸŒ‹`;
                chatBox.appendChild(otherMessage);
                document.getElementById('dealButton').style.display = 'block'; // Show deal button
            }, 1500);
        }

        function sendMessage() {
            const chatInput = document.getElementById('chatInput').value;
            const chatBox = document.getElementById('chatBox');
            const message = document.createElement('div');
            message.textContent = `You: ${chatInput}`;
            chatBox.appendChild(message);

            chatInput.value = ''; // Clear input
            chatBox.scrollTop = chatBox.scrollHeight; // Scroll chat to the bottom
        }

        function confirmDeal() {
            const confirm = window.confirm("Do you want to proceed with the trade?");
            if (confirm) {
                processTrade();
            } else {
                alert("Trade canceled.");
            }
        }

        function processTrade() {
            // Simulate the trade (swap blooks)
            const myLocker = JSON.parse(localStorage.getItem('locker'));
            const theirLocker = ['ðŸŒ‹', 'ðŸ¥‡', 'âš¾']; // Simulate their locker

            // Swap blooks between players (e.g., remove offered and add the other playerâ€™s offer)
            const updatedMyLocker = myLocker.filter(blook => blook !== selectedBlook).concat('ðŸŒ‹');
            const updatedTheirLocker = theirLocker.filter(blook => blook !== 'ðŸŒ‹').concat(selectedBlook);

            // Save updated lockers
            localStorage.setItem('locker', JSON.stringify(updatedMyLocker));

            alert("âœ… Trade completed successfully!");
            location.reload(); // Reload to reset trade state
        }
    </script>

</body>
</html>
